<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>3D Rotations: SO(3) &#8212; pytransform3d 1.3 documentation</title>
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootswatch-3.1.0/readable/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/js/jquery-1.11.0.min.js"></script>
    <script src="_static/js/jquery-fix.js"></script>
    <script src="_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script src="_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="3D Transformations: SE(3)" href="transformations.html" />
    <link rel="prev" title="pytransform3d" href="index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          pytransform3d</a>
        <span class="navbar-text navbar-version pull-left"><b>1.3</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">3D Rotations: SO(3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="transformations.html">3D Transformations: SE(3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="transformation_ambiguities.html">Transformation Ambiguities</a></li>
<li class="toctree-l1"><a class="reference internal" href="transformation_modeling.html">Modeling Transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="transform_manager.html">Transform Manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="camera.html">Camera</a></li>
<li class="toctree-l1"><a class="reference internal" href="animations.html">Animations</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API Documentation</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">3D Rotations: SO(3)</a><ul>
<li><a class="reference internal" href="#rotation-matrix">Rotation Matrix</a></li>
<li><a class="reference internal" href="#axis-angle">Axis-Angle</a></li>
<li><a class="reference internal" href="#euler-angles">Euler Angles</a></li>
<li><a class="reference internal" href="#quaternions">Quaternions</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="index.html" title="Previous Chapter: pytransform3d"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm">&laquo; pytransform3d</span>
    </a>
  </li>
  <li>
    <a href="transformations.html" title="Next Chapter: 3D Transformations: SE(3)"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm">3D Transforma... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">3D Rotations: SO(3)</a><ul>
<li><a class="reference internal" href="#rotation-matrix">Rotation Matrix</a></li>
<li><a class="reference internal" href="#axis-angle">Axis-Angle</a></li>
<li><a class="reference internal" href="#euler-angles">Euler Angles</a></li>
<li><a class="reference internal" href="#quaternions">Quaternions</a></li>
</ul>
</li>
</ul>

  <li>
    <a href="index.html" title="Previous Chapter: pytransform3d"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm">&laquo; pytransform3d</span>
    </a>
  </li>
  <li>
    <a href="transformations.html" title="Next Chapter: 3D Transformations: SE(3)"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm">3D Transforma... &raquo;</span>
    </a>
  </li>
<form action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
        </div>
      </div>
    <div class="col-md-9">
      
  <div class="section" id="d-rotations-so-3">
<h1>3D Rotations: SO(3)<a class="headerlink" href="#d-rotations-so-3" title="Permalink to this headline">¶</a></h1>
<p>The group of all rotations in the 3D Cartesian space is called <img class="math" src="_images/math/f7f7fa0383c715b76a3ed7b029fd07e2f542451a.png" alt="SO(3)"/>
(SO: special orthogonal group).
The minimum number of components that are required to describe any rotation
from <img class="math" src="_images/math/f7f7fa0383c715b76a3ed7b029fd07e2f542451a.png" alt="SO(3)"/> is 3. However, there is no representation that is
non-redundant, continuous and free of singularities. We will now take a closer
look at competing representations of rotations and the orientations they can
describe.</p>
<p>Here is an overview of the representations and the conversions between them
that are available in pytransform3d.</p>
<img alt="Rotations" class="align-center" src="_images/rotations.svg" /><p>The following example illustrates the usage of pytransform3d to perform these
conversions.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="kn">from</span> <span class="nn">pytransform3d.rotations</span> <span class="kn">import</span> <span class="o">*</span>


<span class="n">ax</span> <span class="o">=</span> <span class="n">plot_basis</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">ax_s</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">euler</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">euler</span><span class="p">[</span><span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="n">angle</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">matrix_from_euler_xyz</span><span class="p">(</span><span class="n">euler</span><span class="p">)</span>
<span class="n">plot_basis</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">euler</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">euler</span><span class="p">[</span><span class="mi">2</span> <span class="o">-</span> <span class="n">axis</span><span class="p">]</span> <span class="o">=</span> <span class="n">angle</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">matrix_from_euler_zyx</span><span class="p">(</span><span class="n">euler</span><span class="p">)</span>
<span class="n">plot_basis</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">])</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">matrix_from_angle</span><span class="p">(</span><span class="n">axis</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span>
<span class="n">plot_basis</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">])</span>
<span class="n">e</span> <span class="o">=</span> <span class="p">[</span><span class="n">unitx</span><span class="p">,</span> <span class="n">unity</span><span class="p">,</span> <span class="n">unitz</span><span class="p">][</span><span class="n">axis</span><span class="p">]</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">e</span><span class="p">,</span> <span class="p">(</span><span class="n">angle</span><span class="p">,)))</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">matrix_from_axis_angle</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">plot_basis</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="n">plot_axis_angle</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">])</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">quaternion_from_axis_angle</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">matrix_from_quaternion</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="n">plot_basis</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./../../examples/plot_compare_rotations.py">Source code</a>, <a class="reference external" href="./../../examples/plot_compare_rotations.png">png</a>, <a class="reference external" href="./../../examples/plot_compare_rotations.hires.png">hires.png</a>, <a class="reference external" href="./../../examples/plot_compare_rotations.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/plot_compare_rotations.png" src="_images/plot_compare_rotations.png" />
</div>
<div class="section" id="rotation-matrix">
<h2>Rotation Matrix<a class="headerlink" href="#rotation-matrix" title="Permalink to this headline">¶</a></h2>
<p>The most practical representation of orientation is a rotation matrix</p>
<div class="math">
<p><img src="_images/math/cb15c782df330807e2eeeb7be2b9ee810eae9f11.png" alt="\boldsymbol R =
\left( \begin{array}{ccc}
    r_{11} &amp; r_{12} &amp; r_{13}\\
    r_{21} &amp; r_{22} &amp; r_{23}\\
    r_{31} &amp; r_{32} &amp; r_{33}\\
\end{array} \right)"/></p>
</div><p>Note that</p>
<ul class="simple">
<li><p>this is a non-minimal representation for orientations because we have 9
values but only 3 degrees of freedom</p></li>
<li><p><img class="math" src="_images/math/9b0478c944ec81bbf98d8cb2e9e8ff49466e1f9a.png" alt="\boldsymbol R"/> must be orthonormal</p></li>
<li><p><img class="math" src="_images/math/281193437ad95eb8b4e5588eb17f8b0c57611d79.png" alt="\boldsymbol R^T = \boldsymbol R^{-1}"/></p></li>
<li><p><img class="math" src="_images/math/6daa9be9ce2fce1f2352d4818177fc8a4df785c3.png" alt="det(\boldsymbol R) = 1"/></p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>There are two conventions on how to interpret rotations: active
or passive rotation. The standard in pytransform3d is an active rotation.
Note that there are some functions to generate rotation matrices that
generate passive rotations as well: <a class="reference internal" href="_apidoc/pytransform3d.rotations.matrix_from_angle.html#pytransform3d.rotations.matrix_from_angle" title="pytransform3d.rotations.matrix_from_angle"><code class="xref py py-func docutils literal notranslate"><span class="pre">matrix_from_angle()</span></code></a>,
<a class="reference internal" href="_apidoc/pytransform3d.rotations.matrix_from_euler_xyz.html#pytransform3d.rotations.matrix_from_euler_xyz" title="pytransform3d.rotations.matrix_from_euler_xyz"><code class="xref py py-func docutils literal notranslate"><span class="pre">matrix_from_euler_xyz()</span></code></a>, and
<a class="reference internal" href="_apidoc/pytransform3d.rotations.matrix_from_euler_zyx.html#pytransform3d.rotations.matrix_from_euler_zyx" title="pytransform3d.rotations.matrix_from_euler_zyx"><code class="xref py py-func docutils literal notranslate"><span class="pre">matrix_from_euler_zyx()</span></code></a>. These are kept
for backward compatibility. When in doubt, read the docstring, which
clearly states that a passive convention is used here.</p>
</div>
<p>We can use a rotation matrix <img class="math" src="_images/math/9ea3b600d91c4a102e2079d6497113822460f9ed.png" alt="\boldsymbol R_{AB}"/> to transform a point
<img class="math" src="_images/math/90c4555206db81e4b3ed2a27cd93a1905149beef.png" alt="_B\boldsymbol{p} := _B\boldsymbol{t}_{BP}"/> from frame <img class="math" src="_images/math/4bc3e94a67870b41b7c20179693e889251e2c136.png" alt="B"/> to frame
<img class="math" src="_images/math/211284f68205c3e66773eaf026f32a0acdd3dfb3.png" alt="A"/>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>There are two different conventions on how to use rotation matrices to
apply a rotation to a vector. We can either (pre-)multiply the rotation
matrix to a column vector from the left side or we can (post-)multiply it
to a row vector from the right side.
We will use the <strong>pre-multiplication</strong> convention.</p>
</div>
<p>This means that we rotate a point <img class="math" src="_images/math/66590f2c53625eb372136e2bf77aa724fc887458.png" alt="_B\boldsymbol{p}"/> by</p>
<div class="math">
<p><img src="_images/math/0f3ae92086aab9005716079bcccf60b90242d05d.png" alt="_A\boldsymbol{p} = \boldsymbol{R}_{ABB} \boldsymbol{p}"/></p>
</div><p>This is called <strong>linear map</strong>.</p>
<p>We can see that <em>each column</em> of such a rotation matrix is a basis vector
of frame <img class="math" src="_images/math/211284f68205c3e66773eaf026f32a0acdd3dfb3.png" alt="A"/> with respect to frame <img class="math" src="_images/math/4bc3e94a67870b41b7c20179693e889251e2c136.png" alt="B"/>.</p>
<p>We can plot the basis vectors of an orientation to visualize it.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When plotting basis vectors it is a convention to use red for the x-axis,
green for the y-axis and blue for the z-axis (RGB for xyz).</p>
</div>
<p>Here, we can see orientation represented by the rotation matrix</p>
<div class="math">
<p><img src="_images/math/e91720d98dd90c99b186158afdbe8512b9ab1200.png" alt="\boldsymbol R =
\left( \begin{array}{ccc}
    1 &amp; 0 &amp; 0\\
    0 &amp; 1 &amp; 0\\
    0 &amp; 0 &amp; 1\\
\end{array} \right)"/></p>
</div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pytransform3d.rotations</span> <span class="kn">import</span> <span class="n">plot_basis</span>
<span class="n">plot_basis</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//rotations-1.py">Source code</a>, <a class="reference external" href=".//rotations-1.png">png</a>, <a class="reference external" href=".//rotations-1.hires.png">hires.png</a>, <a class="reference external" href=".//rotations-1.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/rotations-1.png" src="_images/rotations-1.png" />
</div>
<p>We can easily chain multiple rotations: we can apply the rotation defined
by <img class="math" src="_images/math/9ea3b600d91c4a102e2079d6497113822460f9ed.png" alt="\boldsymbol R_{AB}"/> after the rotation <img class="math" src="_images/math/479e6a49216f7964c117c7c6f20334a8789eb239.png" alt="\boldsymbol R_{BC}"/>
by applying the rotation</p>
<div class="math">
<p><img src="_images/math/7de16531e57ecf8c0349877fe60edba4e57fe79b.png" alt="\boldsymbol R_{AC} = \boldsymbol R_{AB} \boldsymbol R_{BC}."/></p>
</div><div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>There are two different conventions on how to concatenate rotation
matrices. Suppose we have a rotation matrix <img class="math" src="_images/math/53cf7ab686c88dcddc7745cf2970c2b6de315c7a.png" alt="R_1"/> and another matrix
<img class="math" src="_images/math/f59def0e720f7de8ca2abe4eb16528d1e9b9f3bf.png" alt="R_2"/> and we want to first rotate by <img class="math" src="_images/math/53cf7ab686c88dcddc7745cf2970c2b6de315c7a.png" alt="R_1"/> and then by
<img class="math" src="_images/math/f59def0e720f7de8ca2abe4eb16528d1e9b9f3bf.png" alt="R_2"/>. If we want to apply both rotations in global coordinates, we
have to concatenate them with <img class="math" src="_images/math/5db82d008f7b95daf144bfc3a194f4852765e8fb.png" alt="R_2 \cdot R_1"/>. We can also express
the second rotation in terms of a local, body-fixed coordinates by
<img class="math" src="_images/math/095df9aa7aeebaf66725086d98973784d835f83e.png" alt="R_1 \cdot R_2"/>, which means <img class="math" src="_images/math/53cf7ab686c88dcddc7745cf2970c2b6de315c7a.png" alt="R_1"/> defines new coordinates in
which <img class="math" src="_images/math/f59def0e720f7de8ca2abe4eb16528d1e9b9f3bf.png" alt="R_2"/> is applied. Note that this applies to both
passive and active rotation matrices.</p>
</div>
<p><strong>Pros</strong></p>
<ul class="simple">
<li><p>It is easy to apply rotations on point vectors</p></li>
<li><p>Concatenation of rotations is trivial</p></li>
<li><p>You can directly read the basis vectors from the columns</p></li>
</ul>
<p><strong>Cons</strong></p>
<ul class="simple">
<li><p>We use 9 values for 3 degrees of freedom</p></li>
<li><p>Not every 3x3 matrix is a valid rotation matrix, which means for example
that we cannot simply apply an optimization algorithm to rotation matrices</p></li>
</ul>
</div>
<div class="section" id="axis-angle">
<h2>Axis-Angle<a class="headerlink" href="#axis-angle" title="Permalink to this headline">¶</a></h2>
<p>Each rotation can be represented by a single rotation around one axis.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">==========</span>
<span class="sd">Axis-angle</span>
<span class="sd">==========</span>

<span class="sd">Any rotation can be represented with a single rotation about some axis.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="vm">__doc__</span><span class="p">)</span>


<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">pytransform3d.rotations</span> <span class="kn">import</span> <span class="p">(</span><span class="n">random_axis_angle</span><span class="p">,</span> <span class="n">matrix_from_axis_angle</span><span class="p">,</span>
                                     <span class="n">plot_basis</span><span class="p">,</span> <span class="n">plot_axis_angle</span><span class="p">)</span>


<span class="n">original</span> <span class="o">=</span> <span class="n">random_axis_angle</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plot_axis_angle</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">original</span><span class="p">)</span>
<span class="k">for</span> <span class="n">fraction</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">):</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">original</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">a</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">fraction</span> <span class="o">*</span> <span class="n">original</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">matrix_from_axis_angle</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">plot_basis</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./../../examples/plot_axis_angle.py">Source code</a>, <a class="reference external" href="./../../examples/plot_axis_angle.png">png</a>, <a class="reference external" href="./../../examples/plot_axis_angle.hires.png">hires.png</a>, <a class="reference external" href="./../../examples/plot_axis_angle.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/plot_axis_angle.png" src="_images/plot_axis_angle.png" />
</div>
<p>The axis can be represented as a three-dimensional unit vector and the angle
by a scalar:</p>
<div class="math">
<p><img src="_images/math/d86f82f765ae252e60e0ab4417af446fa2479141.png" alt="\left( \boldsymbol{\hat{e}}, \theta \right) = \left( \left( \begin{array}{c}e_x\\e_y\\e_z\end{array} \right), \theta \right)"/></p>
</div><p>It is possible to write this in a more compact way as a rotation vector:</p>
<div class="math">
<p><img src="_images/math/ccb507e3b880b1767faa5c6728d51923203b845a.png" alt="\boldsymbol{v} = \theta \boldsymbol{\hat{e}}"/></p>
</div><p><strong>Pros</strong></p>
<ul class="simple">
<li><p>Minimal representation (as rotation vector, also referred to as compact axis-angle in the code)</p></li>
<li><p>It is easy to interpret the representation (as axis and angle)</p></li>
</ul>
<p><strong>Cons</strong></p>
<ul class="simple">
<li><p>Concatenation involves conversion to another representation</p></li>
</ul>
</div>
<div class="section" id="euler-angles">
<h2>Euler Angles<a class="headerlink" href="#euler-angles" title="Permalink to this headline">¶</a></h2>
<p>A complete rotation can be split into three rotations around basis vectors.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>There are 24 different conventions for defining euler angles. There are
12 different valid ways to sequence rotation axes that can be interpreted
as extrinsic or intrinsic rotations: XZX, XYX, YXY, YZY, ZYZ, ZXZ, XZY,
XYZ, YXZ, YZX, ZYX, and ZXY. We will only use the XYZ convention and the
ZYX convention with intrinsic rotations.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">============</span>
<span class="sd">Euler Angles</span>
<span class="sd">============</span>

<span class="sd">Any rotation can be represented by three consecutive rotations about three</span>
<span class="sd">basis vectors. Here we use either the x-y-z convention or the z-y-x convention.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="vm">__doc__</span><span class="p">)</span>


<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="kn">from</span> <span class="nn">pytransform3d.rotations</span> <span class="kn">import</span> <span class="o">*</span>


<span class="n">ax</span> <span class="o">=</span> <span class="n">plot_basis</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">ax_s</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">])</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">matrix_from_euler_xyz</span><span class="p">([</span><span class="n">alpha</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">plot_basis</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">matrix_from_euler_xyz</span><span class="p">([</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">plot_basis</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">p</span><span class="p">)</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">matrix_from_euler_xyz</span><span class="p">([</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">])</span>
<span class="n">plot_basis</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">p</span><span class="p">)</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">])</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">matrix_from_euler_zyx</span><span class="p">([</span><span class="n">alpha</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">plot_basis</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">matrix_from_euler_zyx</span><span class="p">([</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">plot_basis</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">p</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">R</span> <span class="o">=</span> <span class="n">matrix_from_euler_zyx</span><span class="p">([</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">])</span>
<span class="n">plot_basis</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">p</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="./../../examples/plot_euler_angles.py">Source code</a>, <a class="reference external" href="./../../examples/plot_euler_angles.png">png</a>, <a class="reference external" href="./../../examples/plot_euler_angles.hires.png">hires.png</a>, <a class="reference external" href="./../../examples/plot_euler_angles.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="_images/plot_euler_angles.png" src="_images/plot_euler_angles.png" />
</div>
<p><strong>Pros</strong></p>
<ul class="simple">
<li><p>Minimal representation</p></li>
</ul>
<p><strong>Cons</strong></p>
<ul class="simple">
<li><p>24 different conventions</p></li>
<li><p>Singularities (gimbal lock)</p></li>
</ul>
</div>
<div class="section" id="quaternions">
<h2>Quaternions<a class="headerlink" href="#quaternions" title="Permalink to this headline">¶</a></h2>
<p>Quaternions are represented by a scalar / real part <img class="math" src="_images/math/cc87ee665749db882f94e0d3707eb23e39638650.png" alt="w"/>
and an imaginary / vector part
<img class="math" src="_images/math/296b7098a4e3f5fcb52474893f620ff2889fb5b6.png" alt="x \boldsymbol{i} + y \boldsymbol{j} + z \boldsymbol{k}"/>.</p>
<div class="math">
<p><img src="_images/math/79e9a168c219f2d86faef761347296ae5ab96899.png" alt="\boldsymbol{q} = w + x \boldsymbol{i} + y \boldsymbol{j} + z \boldsymbol{k}"/></p>
</div><div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>There are two different quaternion conventions: Hamilton’s convention
defines <img class="math" src="_images/math/64e011788d9a16919f70050b9abb41dd0d11b27a.png" alt="ijk = -1"/> and the JPL convention (from NASA’s Jet Propulsion
Laboratory, JPL) defines <img class="math" src="_images/math/0e435392bb9407c662458c942eabdc96786b4a87.png" alt="ijk = 1"/>. We use Hamilton’s convention.</p>
</div>
<p>Read <a class="reference external" href="https://arxiv.org/pdf/1801.07478.pdf">this paper</a> for details about the
two conventions and why Hamilton’s convention should be used. Section VI A
gives useful hints to identify which convention is used.</p>
<p>The unit quaternion space <img class="math" src="_images/math/78a1421a1c9df3cee32686f45ad59741e81f1f6d.png" alt="S^3"/> can be used to represent orientations.
To do that, we use an encoding based on the rotation axis and angle.
A rotation quaternion is a four-dimensional unit vector (versor)
<img class="math" src="_images/math/ccac8697bdb80904a21d231b0f7103543f8001f2.png" alt="\boldsymbol{\hat{q}}"/>.
The following equation describes its relation to axis-axis notation.</p>
<div class="math">
<p><img src="_images/math/eff54f1298025c7a146f02daf51b8fce6c3f6649.png" alt="\boldsymbol{\hat{q}} =
\left( \begin{array}{c} w\\ x\\ y\\ z\\ \end{array} \right) =
\left( \begin{array}{c}
    \cos \frac{\theta}{2}\\
    e_x \sin \frac{\theta}{2}\\
    e_y \sin \frac{\theta}{2}\\
    e_z \sin \frac{\theta}{2}\\
\end{array} \right)"/></p>
</div><div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The scalar component <img class="math" src="_images/math/cc87ee665749db882f94e0d3707eb23e39638650.png" alt="w"/> of a quaternion is sometimes the first
element and sometimes the last element of the versor. We will use
the first element to store the scalar component.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The unit quaternions <img class="math" src="_images/math/ccac8697bdb80904a21d231b0f7103543f8001f2.png" alt="\boldsymbol{\hat{q}}"/> and
<img class="math" src="_images/math/86225c865643a22807d20c325823a7d08846f8b6.png" alt="-\boldsymbol{\hat{q}}"/> represent exactly the same rotation.</p>
</div>
<p><strong>Pros</strong></p>
<ul class="simple">
<li><p>More compact than the matrix representation and less susceptible to
round-off errors</p></li>
<li><p>The quaternion elements vary continuously over the unit sphere in
<img class="math" src="_images/math/1963e1d8fcb281cbc6b8edecfb23c75fd27f06e8.png" alt="\mathbb{R}^4"/> as the orientation changes, avoiding discontinuous
jumps (inherent to three-dimensional parameterizations)</p></li>
<li><p>Expression of the rotation matrix in terms of quaternion parameters
involves no trigonometric functions</p></li>
<li><p>Concatenation is simple and computationally cheaper with the quaternion
product than with rotation matrices</p></li>
</ul>
<p><strong>Cons</strong></p>
<ul class="simple">
<li><p>The representation is not straightforward to interpret</p></li>
<li><p>There are always two unit quaternions that represent exactly the same
rotation</p></li>
</ul>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2014-2020, Alexander Fabisch, DFKI GmbH, Robotics Innovation Center.<br/>
      Last updated on Nov 20, 2020.<br/>
    </p>
  </div>
</footer>
  </body>
</html>